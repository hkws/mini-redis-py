## title
Pythonで作る小さなRedis


## abstract
本ワークショップでは、Python/asyncioで一部の基本的な機能に限定したRedisを自作し、RESP（REdis Serialization Protocol）やRedisの機能について理解を深めることを目的とします。
まずみなさんが目標とするのは、
・RESPのArraysやBulkを実装した、CRLF境界を扱えるパーサの作成
・asyncioでのシンプルなTCPサーバの実装
・PING/GET/SET/INCR 処理の完成
です。redis-cliコマンドで実装したRedisサーバにアクセスし、実際に手元で動作することを実感しながら実装を進めていきます。
発展的なテーマとして、EXPIREコマンドの実装を行います。Redisが採用しているpassive/activeな期限切れキーの扱いについても学ぶことができます。


## 得られるもの
・RESPの基本的な知識とそのパース処理の実装
・asyncioによるTCPサーバーの実装を通じた基本知識
・Redisが採用する期限管理の方法と実装


## 詳細
講師は当日までに以下のものを準備します。
・講義スライド
・受講者用の実装の雛形
・動作確認用の自動テスト
・完成系の参考実装

当日は以下の流れで行う予定です。基本的には60分での進行を想定しておりますが、90分でも対応できます。

1. 導入（5分）
・Redisに関する基本的な知識の確認
・目標物のデモ（`PING/GET/SET/INCR/EXPIRE`）
・RESPの最小要素（Arrays/Bulk、CRLF終端、長さ指定）の確認。

2. TCPサーバ＆コマンド呼び出し（15分）
・asyncio でTCPサーバを立て、受信→解釈→コマンド実行→応答をループできる状態を達成

3. 「メッセージの切り出し・読み取り」（15分）
・ストリームから1行読み、Bulkの長さ指定に従って本体を読み出す処理を中心に実装

4. 基本コマンド実装（20分）
・`PING/GET/SET/INCR` コマンドを追加
・redis-cliで実際に所望の動作を行うことを確認

5. （発展）EXPIRE：passive + active 方式
・Redisの実際の実装思想に沿って、アクセス時の期限判定（passive）と、バックグラウンドでの定期削除（active）を実装
・passive：`GET/INCR/SET` 等の入口で期限を確認し、期限切れならその場で削除
・active：バックグラウンドでランダムサンプリング型の期限チェックサイクル

6. まとめと更なる発展（5分）

